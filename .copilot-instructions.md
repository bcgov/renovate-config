# AI Assistant Instructions for Renovate Config Repository

This file is specific to `bcgov/renovate-config`. Follow these guardrails when proposing changes.

## Critical Operations Requiring Explicit Permission

### Releases & Tags
- NEVER create or delete tags or releases without explicit permission.
- NEVER trigger release workflows without explicit permission.

### Repository Management
- NEVER force-push to `main`.
- ALWAYS ask before changes that could break downstream repositories.
- ALWAYS test locally when possible.
- ALWAYS validate Renovate configurations locally before committing:

```bash
npx --yes -p renovate renovate-config-validator --strict default.json renovate.json rules-*.json5
```

### Workflow & CI/CD
- NEVER modify GitHub Actions workflows without explicit permission.
- NEVER change CI/CD configurations without explicit permission.

### Pull Request Management
- Use file-based PR body updates to avoid shell escaping issues:
```bash
# Create PR body file
printf '%s\n' "<your PR body>" > pr_body.md
# Update PR with file
gh pr edit --title "<Title>" --body-file pr_body.md
# Clean up
rm -f pr_body.md
```
- AVOID inline `--body` with special characters.

## Configuration Consistency Rules
- NEVER mix versioned and unversioned preset references in the same file.
- When editing presets (e.g., `default.json`):
  - If consumers use unversioned (`github>bcgov/renovate-config`), keep internal references unversioned.
  - If consumers use versioned (`github>bcgov/renovate-config#v1`), keep internal references versioned.
- ALWAYS verify preset reference consistency before committing.

## General Preferences
- Prefer incremental, verified changes over large refactors.
- Ensure functionality before making multiple changes.
- Prefer frequent and small pull requests.
- Never use local `.env` files.
